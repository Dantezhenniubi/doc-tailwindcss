---
outline: [1, 6]
---

# 踩坑记录

本文用于记录开发过程中遇到的一些问题以及解决方法，用于后续参考。<br>
使用这样的格式记录:<br>

```md
## 问题简述

2025-8-15 问题描述
解决方法
```

## Github仓库文件大小写导致的路由识别错误

2025-8-15 问题描述：
在Github仓库中，文件的大小写会导致路由识别错误。我的vitepress项目的侧边栏本地能显示，上线后显示不出来。经过排查，是因为我创建的文件夹名为`Vitepress功能`，而我在侧边栏配置中，如果写的是`Vitepress功能`，在上线后是显示不出来侧边栏的。<br>
看代码，此时，我的文件夹名是大写的，路由也是大写的：
::: CTcode

```js
"/docs/others/写文章相关/Vitepress功能/": [
        // 过滤图片文件夹和临时文件
        set_sidebar_smart(
          "拓展语法",
          "/docs/others/写文章相关/Vitepress功能/拓展语法/"
        ),
      ],
```

:::
让我们看看上线后是怎样呢？<br>
![](https://raw.githubusercontent.com/Dantezhenniubi/image-repo/master/20250815193602.png)
可以看到，侧边栏显示不出来。<br>
但是我们看看本地呢？<br>
![](https://raw.githubusercontent.com/Dantezhenniubi/image-repo/master/20250815193834.png)
可以看到，侧边栏是显示出来的。<br>
这是因为上传到Github仓库时，**文件夹名会变成小写**，而我在侧边栏配置中写的是大写，所以导致侧边栏路由识别错误。<br>
![](https://raw.githubusercontent.com/Dantezhenniubi/image-repo/master/20250815194118.png)

解决方法：
**我们统一使用小写即可，侧边栏配置中也统一使用小写。**<br>
::: tip 插个眼
不知道上传到GitHub仓库默认变为小写是不是仓库设置的问题，待后续查明
:::
可以看到，侧边栏路由识别错误的问题已经解决。<br>
![](https://raw.githubusercontent.com/Dantezhenniubi/image-repo/master/20250815195403.png)

## 更改文件名大小写提交后不一致

2025-8-30 问题描述: 由于git默认配置对大小写不敏感，我更改了导入部分的文件名`Linkcard`为`LinkCard`，并提交到仓库中，但是文件本身忘记改名了。。这时候git也检测不到
解决方法：

1. 配置 Git 区分大小写（如果尚未配置）

```sh
git config core.ignorecase false
```

2. 强制 Git 识别文件名大小写更改

```sh
# 先删除旧文件名（小写）的缓存
git rm --cached .vitepress/theme/components/Linkcard.vue

# 添加新文件名（大写）的缓存
git add .vitepress/theme/components/LinkCard.vue
```

## 自定义字体时的CSS导入顺序

2025-8-16 问题描述：
vitepress自定义字体时，需要导入字体的CSS文件`my-fonts.css`，但是开始发现并没有生效。
::: danger 错误写法

```js
import './my-fonts.css';
import DefaultTheme from 'vitepress/theme-without-fonts';

export default DefaultTheme;
```

:::
后面发现，是因为自定义字体CSS必须要在默认主题后导入，这是由于CSS 的 Cascade 层叠规则导致的。<br>
详细理论可参考[CSS 层叠规则](./../../Front-end/CSS相关/CSS层叠规则.md)

后面的CSS文件会覆盖前面的CSS文件，所以自定义字体CSS必须要在默认主题后导入。<br>

::: success 正确写法

```js
import DefaultTheme from 'vitepress/theme-without-fonts';
// 这里顺序很重要！！！
import './my-fonts.css';

export default DefaultTheme;
```

:::

## 命令行cspell报错

2025-8-30 问题描述: 命令行一直有单词cspell拼写检查报错，导致提交钩子失败无法提交代码
解决方法：
本来以为得安装cspell拓展`@cspell/eslint-plugin`，结果直接在编辑器的插件里搜`Code Spell Checker`打开设置，在插件设置里关掉插件，或者在ignorewords中添加要忽略检查的单词就行了。

## ts接口没有默认值的报错

2025-8-30 问题描述: eslint检查警告ts接口没有默认值，该警告提示是因为在使用 withDefaults 为 prop 设置默认值时，仍将其类型定义为必需（required），这在逻辑上冲突。应将 prop 定义为可选。
解决方法：
将 Props 接口中对应的 prop 类型设置为可选（即加上 ?），以匹配 withDefaults 提供的默认值，消除 ESLint 警告。
::: CTcode

```ts
interface Props {
  url: string;
  title: string;
  description: string;
  logo: string;
}
```

改为：

```ts
interface Props {
  url?: string;
  title?: string;
  description?: string;
  logo?: string;
}
```

:::

## SSR服务端渲染导致的错误
2025-8-30 问题描述:
我vitepress编写了一个文章瀑布流动画组件，它操作了`document`对象，但是由于是服务端渲染，所以会报错，SSR环境不可用。
解决方法：

在config配置中添加vite相关配置：
::: CTcode
```js
export default { 
  vite: {
    build: {
      // 解决大文件警告
      chunkSizeWarningLimit: 1000,
    },
    ssr: {
      // 解决 Element Plus CSS 在 SSR 中的问题
      noExternal: ['element-plus'],
    },
  }
}
```
:::

对于组件的代码：
1. 添加 inBrowser 检测：
::: CTcode
```js
import { useRoute, inBrowser } from 'vitepress';
```
:::
2. 创建安全的 DOM 操作函数：
::: CTcode
```js
const safeQuerySelectorAll = (selector) => {
  if (!inBrowser) return [];
  return document.querySelectorAll(selector);
};
```
:::
3. 所有 DOM 操作前添加 inBrowser 检查：
::: CTcode
```js
// 在所有使用 document、window 的地方添加检查
if (inBrowser) {
  // DOM 操作代码
}
```
:::


vitepress的`<ClientOnly>`[官方](https://vitepress.dev/guide/ssr-compat#clientonly)没试过，不知道有没有用